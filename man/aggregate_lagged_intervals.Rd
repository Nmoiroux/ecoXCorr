% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funs.R
\name{aggregate_lagged_intervals}
\alias{aggregate_lagged_intervals}
\title{Aggregate meteorological time series over multiple lagged time intervals}
\usage{
aggregate_lagged_intervals(
  data,
  date_col,
  value_cols,
  d,
  i = 1,
  m,
  funs = list(mean = mean, min = min, max = max, sum = sum),
  na.rm = TRUE
)
}
\arguments{
\item{data}{A data.frame containing the meteorological time series.}

\item{date_col}{Character string giving the name of the date column in
\code{data}. The column must be of class \code{Date} or \code{POSIXct}.}

\item{value_cols}{Character vector giving the names of numeric variables
to be aggregated (e.g. rainfall, temperature).}

\item{d}{Vector of reference *dates*. Can be of class \code{Date} or coercible
to \code{Date}. Aggregations are computed independently for each date.}

\item{i}{Integer giving the length of the base time *interval*, expressed in days
(e.g. \code{1} for daily data, \code{7} for weekly intervals,
\code{14} for fortnightly intervals).}

\item{m}{Integer giving the *maximum* lag (number of intervals) to consider.
All combinations of lag windows with \code{1 <= lag_end <= lag_start <= m}
are evaluated.}

\item{funs}{Named list of aggregation functions to apply to each variable.
Each function must accept a numeric vector as first argument. The names
of the list are used to construct output column names
(e.g. \code{rain_mean}, \code{temp_max}). Defaults to mean, min, max and sum.}

\item{na.rm}{Logical indicating whether missing values should be removed
before aggregation. Passed to the aggregation functions (default: \code{TRUE}).}
}
\value{
A data.frame with one row per reference date and lag window, containing:
  \itemize{
    \item \code{date}: reference date
    \item \code{start}, \code{end}: start (inclusive) and end (exclusive) of
      the aggregation interval
    \item \code{lag_start}, \code{lag_end}: lag indices defining the interval
    \item One column per combination of variable and aggregation function
      (e.g. \code{rain_mean}, \code{temperature_sum})
  }
}
\description{
This function computes aggregated values of one or several meteorological
time series over all possible lagged time intervals defined relative to one
or more reference dates. For each reference date \code{d}, all intervals
\eqn{[d - k \times i,\; d - (l-1) \times i)} are generated,
where \code{i} is the interval length (in days) and \code{k, l} range from 1 to \code{m} with
\code{k >= l}. Each interval is then used to aggregate the specified
meteorological variables using one or more summary functions.
}
\details{
The function supports multiple reference dates, multiple variables, and
multiple aggregation functions, and returns all combinations as additional
columns in the output data frame.

Reference dates for which at least one interval contains no observations are
reported in the console as having missing data. Reference dates for which at
least one interval partially lies outside the temporal bounds of the input
time series are reported as having truncated intervals.


Intervals are defined as left-closed and right-open
(\code{[start, end)}). An interval is considered truncated if it extends
beyond the temporal bounds of the input time series. An interval is considered
missing if no observations fall within it.

Console messages are printed to inform the user of reference dates for which
missing data or truncated intervals occurred.
}
