% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/funs.R
\name{plotCCM}
\alias{plotCCM}
\title{Plot a cross-correlation map (CCM) from lagged regression results}
\usage{
plotCCM(data, threshold_p = 1)
}
\arguments{
\item{data}{A data.frame produced by \code{\link{fit_models_by_lag}}, containing
at least the columns \code{lag_start}, \code{lag_end}, \code{r2},
\code{p_value}, and \code{sign}.}

\item{threshold_p}{Numeric value giving the p-value threshold above which
associations are masked (set to \code{NA}) in the plot. Default is \code{1},
meaning that no filtering is applied.}
}
\value{
A \code{ggplot2} object representing the cross-correlation map.
}
\description{
This function visualises the strength and direction of associations between
a response variable and a lagged predictor across multiple lag windows, using
the output of \code{\link{fit_models_by_lag}}. The resulting plot is a
two-dimensional "cross-correlation map", where each tile represents a
lag window defined by \code{lag_start} and \code{lag_end}.
}
\details{
The colour of each tile corresponds to a signed coefficient of determination
(\eqn{R^2}), computed as the marginal or classical \eqn{R^2} multiplied by the
sign of the estimated effect. Positive associations are shown in red, negative
associations in blue, and non-significant or filtered values are shown in grey.

The lag window yielding the maximum \eqn{R^2} is highlighted with a coloured
border.


The x-axis corresponds to \code{lag_start} (displayed in reverse order), and
the y-axis corresponds to \code{lag_end}. Tiles are coloured using a diverging
colour scale centred on zero. Lag windows with \code{p_value >= threshold_p}
are not displayed and appear in grey.

This function does not perform any modelling itself; it is intended solely
for visualising results obtained from \code{\link{fit_models_by_lag}}.
}
\seealso{
\code{\link{fit_models_by_lag}}, \code{\link[ggplot2]{ggplot}}
}
